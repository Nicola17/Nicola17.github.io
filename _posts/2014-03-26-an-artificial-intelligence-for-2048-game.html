---
layout: post
title: An Artificial Intelligence for the 2048 game
date: '2014-03-26T22:42:00.000+01:00'
author: Nicola Pezzotti
tags:
- '2048'
- Algorithms
- StackOverflow
- Python
- Artificial Intelligence
modified_time: '2014-03-26T23:58:27.514+01:00'
thumbnail: http://2.bp.blogspot.com/-dl4lNeZZd08/UzMcgTMPe2I/AAAAAAAABzo/YqzvOZwwKwA/s72-c/record.png
blogger_id: tag:blogger.com,1999:blog-7911490130261214164.post-294082845438923801
blogger_orig_url: http://diaryofatinker.blogspot.com/2014/03/an-artificial-intelligence-for-2048-game.html
---

Lately the <a href="http://gabrielecirulli.github.io/2048/">2048 game</a>&nbsp;reached a good notoriety on the internet.<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br /><br />A discussion about possible algorithms which solve the 2048 game arose on <a href="http://stackoverflow.com/questions/22342854/what-is-the-optimal-algorithm-for-the-game-2048">StackOverflow</a>.<br /><div><span style="background-color: white; color: #222222; font-family: 'Times New Roman', serif; font-size: 18px;"><br /></span></div><div>The main discussed algorithms are:<br /><ul><li><a href="https://github.com/ov3y/2048-AI">https://github.com/ov3y/2048-AI</a>&nbsp;(<a href="http://stackoverflow.com/users/1056032/ovolve">ovolve</a>)- A <a href="http://en.wikipedia.org/wiki/Minimax">minimax</a> approach which take into account several heuristic functions -&nbsp;I tested it out and it turned out to have some problems in reaching the 4098 tile in a reliable way</li><li><a href="https://github.com/nneonneo/2048-ai">https://github.com/nneonneo/2048-ai</a>&nbsp;(<a href="http://stackoverflow.com/users/1204143/nneonneo">nneonneo</a>)- A very efficient implementation of an <a href="http://en.wikipedia.org/wiki/Expectiminimax_tree">Expectiminimax </a>approach with a quite simple heuristic - AFAIK he has reached the highest score of 173364 but I have not tried it yet</li></ul><br />The solution I propose is very simple and easy to implement. Although, it has reached the score of 131040. Several benchmarks of the algorithm performances are presented.<br /><br /><div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-dl4lNeZZd08/UzMcgTMPe2I/AAAAAAAABzo/YqzvOZwwKwA/s1600/record.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-dl4lNeZZd08/UzMcgTMPe2I/AAAAAAAABzo/YqzvOZwwKwA/s1600/record.png" height="80" width="400" /></a></div><br /></div><h3>Algorithm</h3><h4><b>Heuristic scoring algorithm</b></h4>The assumption on which my algorithm is based is rather simple: if you want to achieve higher score, the board must be kept as tidy as possible. In particular, the optimal setup is given by a linear and monotonic decreasing order of the tile values.<br /><br />This intuition will give you also the upper bound for a tile value: $2^{n} \rightarrow 2^{16} = 65536$ where $n$ is the number of tile on the board. (There's a possibility to reach the 131072 tile if the 4-tile is randomly generated instead of the 2-tile when needed)<br /><br />Two possible ways of organizing the board are shown in the following images<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-OMlNFEUdlFM/UzHZGe8LHnI/AAAAAAAABzU/nGb-03BvKSM/s1600/2048.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-OMlNFEUdlFM/UzHZGe8LHnI/AAAAAAAABzU/nGb-03BvKSM/s1600/2048.png" height="197" width="400" /></a></div><br /><br />To enforce the ordination of the tiles in a monotonic decreasing order, the score si computed as the sum of the linearized values on the board multiplied by the values of a <a href="http://en.wikipedia.org/wiki/Geometric_progression">geometric sequence</a>&nbsp;with common ratio $r&lt;1$ .<br /><br /><div style="text-align: center;">$p_n \in Path_{0 \cdots N-1}$</div><div style="text-align: center;"><br /></div><div style="text-align: center;">$score = \sum_{n=0}^{N-1} value(p_n) * r^n$</div><br />Several linear path could be evaluated at once, the final score will be the maximum score of any path.<br /><br /><h4></h4><h4>Decision rule</h4>The <a href="http://en.wikipedia.org/wiki/Decision_rule">decision rule</a> implemented is not quite smart, the code in Python is presented here:<br /><br /><script class="brush: python" type="syntaxhighlighter"><![CDATA[     @staticmethod     def nextMove(board,recursion_depth=3):         m,s = AI.nextMoveRecur(board,recursion_depth,recursion_depth)         return m              @staticmethod     def nextMoveRecur(board,depth,maxDepth,base=0.9):         bestScore = -1.         bestMove = 0         for m in range(1,5):             if(board.validMove(m)):                 newBoard = copy.deepcopy(board)                 newBoard.move(m,add_tile=True)                                  score = AI.evaluate(newBoard)                 if depth != 0:                     my_m,my_s = AI.nextMoveRecur(newBoard,depth-1,maxDepth)                     score += my_s*pow(base,maxDepth-depth+1)                                      if(score > bestScore):                     bestMove = m                     bestScore = score         return (bestMove,bestScore);  ]]></script> An implementation of the <a href="http://en.wikipedia.org/wiki/Minimax">minmax</a> or the <a href="http://en.wikipedia.org/wiki/Expectiminimax_tree">Expectiminimax</a> will surely improve the algorithm. Obviously a more<br />sophisticated decision rule will slow down the algorithm and it will require some time to be implemented.I will try a minimax implementation in the near future. (stay tuned)<br /><br /><h3>Benchmark</h3><h2></h2><div><br /><ul><li>T1&nbsp;- 121 tests - 8 different paths - $r = 0.125$&nbsp;</li><li>T2&nbsp;- 122 tests&nbsp;- 8-different paths&nbsp;- $r = 0.25$&nbsp;</li><li>T3&nbsp;- 132 tests&nbsp;- 8-different paths&nbsp;- $r = 0.5$</li><li>T4&nbsp;- 211 tests&nbsp;- 2-different paths&nbsp;- $r = 0.125$</li><li>T5&nbsp;- 274 tests&nbsp;- 2-different paths&nbsp;- $r = 0.25$</li><li>T6&nbsp;- 211 tests&nbsp;- 2-different paths&nbsp;- $r = 0.5$</li></ul><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-_xY9Q5sF-Nc/UzNFCVkDaXI/AAAAAAAAB0Q/NCJwkpvQ0tU/s1600/g0.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-_xY9Q5sF-Nc/UzNFCVkDaXI/AAAAAAAAB0Q/NCJwkpvQ0tU/s1600/g0.png" /></a><a href="http://1.bp.blogspot.com/-aYA8rJdIbzk/UzNFAJXzQEI/AAAAAAAABz4/LkpWBydEF_o/s1600/g1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-aYA8rJdIbzk/UzNFAJXzQEI/AAAAAAAABz4/LkpWBydEF_o/s1600/g1.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-y3ELuyb1vxQ/UzNFBK7LDuI/AAAAAAAAB0A/GdCgJiT-b8g/s1600/g3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-y3ELuyb1vxQ/UzNFBK7LDuI/AAAAAAAAB0A/GdCgJiT-b8g/s1600/g3.png" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-w-VP1a0BLHU/UzNFAeuiTjI/AAAAAAAABz8/f11GCbllTIY/s1600/g2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-w-VP1a0BLHU/UzNFAeuiTjI/AAAAAAAABz8/f11GCbllTIY/s1600/g2.png" /></a></div><br />In case of T2, four tests in ten generate the 4096 tile with an average score of $\sim 42000$<br /><br /></div><h3>Code</h3><div>The code can be found on GiHub at the following link:&nbsp;<a href="https://github.com/Nicola17/term2048-AI">https://github.com/Nicola17/term2048-AI</a><br />It is based on <a href="https://github.com/bfontaine/term2048">term2048</a>&nbsp;and it's written in Python. I will implement a more efficient version in C++ as soon as possible.<br /><br /><h3>StackOverflow</h3></div></div><div>You can upvote my answer on StackOverflow <a href="http://stackoverflow.com/questions/22342854/what-is-the-optimal-algorithm-for-the-game-2048/22674149#22674149">here</a>&nbsp;:)</div>